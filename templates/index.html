<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heart Health Hub</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>

<!-- Loading Screen -->
<div id="loading-screen">
    <div class="heart-pulse-container">
        <div class="heart-icon"></div>
    </div>
</div>

<!-- Main Container -->
<div class="main-container">

    <!-- Left Section: Information and Resources -->
    <div class="info-section">
        <div class="content-wrapper">
            <canvas id="heartCanvas"></canvas>
            <div class="info-text-container">
                <h2 class="section-title">Understanding Heart Health</h2>
                <p>Cardiovascular disease is a leading health concern globally. However, understanding the risks and taking proactive steps can significantly improve your long-term health. This app is designed to help you assess your risk, but it's crucial to learn about the underlying factors.</p>

                <div class="info-box">
                    <h3>Key Risk Factors</h3>
                    <ul>
                        <li><strong>Diet:</strong> High intake of saturated fats and sodium.</li>
                        <li><strong>Lifestyle:</strong> Lack of physical activity and smoking.</li>
                        <li><strong>Medical Conditions:</strong> High blood pressure, high cholesterol, and diabetes.</li>
                        <li><strong>Genetics:</strong> Family history of heart disease.</li>
                    </ul>
                </div>

                <div class="info-box">
                    <h3>How to Prevent Heart Disease</h3>
                    <ul>
                        <li><strong>Healthy Diet:</strong> Focus on fruits, vegetables, whole grains, and lean proteins.</li>
                        <li><strong>Regular Exercise:</strong> Aim for at least 150 minutes of moderate exercise per week.</li>
                        <li><strong>Stress Management:</strong> Practice mindfulness, meditation, or yoga.</li>
                        <li><strong>Routine Check-ups:</strong> Monitor your blood pressure, cholesterol, and blood sugar.</li>
                    </ul>
                </div>

               <div class="video-section">
                    <h3 class="section-title">Watch and Learn</h3>
                    <p>Watch this video to get a clear idea about heart disease and effective prevention methods.</p>
                    <div class="video-container">
                        <iframe
                            src="https://www.youtube.com/embed/rCqzV-JdNLY"
                            frameborder="0"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                            allowfullscreen>
                        </iframe>
                    </div>
                </div>

                <div class="pdf-section">
                    <h3 class="section-title">Deep Dive into Heart Disease</h3>
                    <p>For a comprehensive guide on heart health, prevention, and living a heart-healthy lifestyle, download our detailed resource guide.</p>
                    <a href="https://www.cdc.gov/heartdisease/docs/Prevent-Heart-Disease-Brochure.pdf" class="pdf-link" target="_blank">Download Full Health Guide (PDF)</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Right Section: The Prediction App -->
    <div class="app-section">
        <div class="card">
            <header class="app-header">
                <h1>Heart Health Predictor</h1>
                <p class="subtitle">Enter patient details to receive a risk assessment.</p>
            </header>

            <form id="predictionForm">
                <div class="form-group">
                    <label for="age">Age</label>
                    <input type="number" id="age" required placeholder="e.g., 52">
                    <small class="form-text">Patient's age in years.</small>
                </div>
                <div class="form-group">
                    <label for="sex">Sex</label>
                    <input type="number" id="sex" placeholder="Male: 1, Female: 0" required>
                    <small class="form-text">Categorical value for gender.</small>
                </div>
                <div class="form-group">
                    <label for="cp">Chest Pain Type</label>
                    <input type="number" id="cp" placeholder="0=Asymptomatic, 1=Atypical Angina, 2=Typical Angina, 3=Non-anginal" required>
                    <small class="form-text">Type of chest pain reported.</small>
                </div>
                <div class="form-group">
                    <label for="trestbps">Resting Blood Pressure (mm Hg)</label>
                    <input type="number" id="trestbps" placeholder="e.g., 120" required>
                    <small class="form-text">The patient's blood pressure at rest.</small>
                </div>
                <div class="form-group">
                    <label for="chol">Serum Cholesterol (mg/dl)</label>
                    <input type="number" id="chol" placeholder="e.g., 200" required>
                    <small class="form-text">Cholesterol level in mg/dl.</small>
                </div>
                <div class="form-group">
                    <label for="fbs">Fasting Blood Sugar > 120 mg/dl</label>
                    <input type="number" id="fbs" placeholder="No: 0, Yes: 1" required>
                    <small class="form-text">Indicates if fasting blood sugar is high.</small>
                </div>
                <div class="form-group">
                    <label for="restecg">Resting ECG</label>
                    <input type="number" id="restecg" placeholder="0=Normal, 1=ST-T wave abnormality, 2=Left Ventricular Hypertrophy" required>
                    <small class="form-text">Result of the resting electrocardiogram.</small>
                </div>
                <div class="form-group">
                    <label for="thalach">Max Heart Rate Achieved</label>
                    <input type="number" id="thalach" placeholder="e.g., 150" required>
                    <small class="form-text">Maximum heart rate recorded during exercise.</small>
                </div>
                <div class="form-group">
                    <label for="exang">Exercise Induced Angina</label>
                    <input type="number" id="exang" placeholder="No: 0, Yes: 1" required>
                    <small class="form-text">Indicates if chest pain was induced by exercise.</small>
                </div>
                <div class="form-group">
                    <label for="oldpeak">ST Depression (Oldpeak)</label>
                    <input type="number" step="0.1" id="oldpeak" placeholder="e.g., 1.5" required>
                    <small class="form-text">ECG result showing ST depression during exercise.</small>
                </div>
                <div class="form-group">
                    <label for="slope">Slope of Peak Exercise ST Segment</label>
                    <input type="number" id="slope" placeholder="0=Upsloping, 1=Flat, 2=Downsloping" required>
                    <small class="form-text">Slope of the ST segment of the ECG during peak exercise.</small>
                </div>
                <div class="form-group">
                    <label for="ca">Number of Major Vessels (0-4)</label>
                    <input type="number" id="ca" placeholder="e.g., 0-4" required>
                    <small class="form-text">Number of major blood vessels detected by fluoroscopy.</small>
                </div>
                <div class="form-group">
                    <label for="thal">Thalassemia (0-3)</label>
                    <input type="number" id="thal" placeholder="0=Normal, 1=Fixed defect, 2=Reversible defect" required>
                    <small class="form-text">A genetic blood disorder affecting oxygen-carrying capacity.</small>
                </div>

                <button type="submit" class="btn btn-primary">Predict</button>
            </form>

            <div id="result-container" class="result-box">
                <p id="result-text"></p>
            </div>
        </div>
    </div>

</div>
<footer class="footer">
    <p>Developed by Creovate labs ðŸ©º Â© 2025</p>
</footer>
<script>
    // All JavaScript from loading.js and animation.js goes here

    // Loading Screen Logic
    document.addEventListener('DOMContentLoaded', function() {
        const loadingScreen = document.getElementById('loading-screen');
        const heartIcon = document.querySelector('.heart-pulse-container .heart-icon');

        const heartColor = '#dc3545';
        const svgContent = `
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="${heartColor}">
                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5A5.48 5.48 0 017.5 3C9.36 3 11 4.29 12 5.57 13 4.29 14.64 3 16.5 3a5.48 5.48 0 015.5 5.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
            </svg>
        `;
        heartIcon.innerHTML = svgContent;
    });

    // Main Animation Logic
    function startCanvasAnimation() {
        const canvas = document.getElementById('heartCanvas');
        const ctx = canvas.getContext('2d');

        function resizeCanvas() {
            canvas.width = canvas.parentElement.offsetWidth;
            canvas.height = canvas.parentElement.offsetHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        let heartSize = 50;
        const maxSize = 60;
        const minSize = 50;
        let pulseDirection = 1;
        const pulseSpeed = 0.2;
        const heartColor = '#dc3545';

        function drawHeart(x, y, size) {
            ctx.beginPath();
            ctx.moveTo(x, y + size / 4);
            ctx.bezierCurveTo(x + size / 2, y - size / 2, x + size, y, x, y + size);
            ctx.bezierCurveTo(x - size, y, x - size / 2, y - size / 2, x, y + size / 4);
            ctx.closePath();
            ctx.fillStyle = heartColor;
            ctx.fill();
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            heartSize += pulseDirection * pulseSpeed;
            if (heartSize >= maxSize) {
                pulseDirection = -1;
            } else if (heartSize <= minSize) {
                pulseDirection = 1;
            }
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            drawHeart(centerX, centerY, heartSize);
            requestAnimationFrame(animate);
        }
        animate();
    }

    // Main App Logic
    window.onload = function() {
        const loadingScreen = document.getElementById('loading-screen');
        const loadingDuration = 3000;
        setTimeout(function() {
            loadingScreen.style.opacity = '0';
            loadingScreen.style.visibility = 'hidden';
            startCanvasAnimation();
        }, loadingDuration);

        document.getElementById('predictionForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const formData = {
                age: parseFloat(document.getElementById('age').value),
                sex: parseFloat(document.getElementById('sex').value),
                cp: parseFloat(document.getElementById('cp').value),
                trestbps: parseFloat(document.getElementById('trestbps').value),
                chol: parseFloat(document.getElementById('chol').value),
                fbs: parseFloat(document.getElementById('fbs').value),
                restecg: parseFloat(document.getElementById('restecg').value),
                thalach: parseFloat(document.getElementById('thalach').value),
                exang: parseFloat(document.getElementById('exang').value),
                oldpeak: parseFloat(document.getElementById('oldpeak').value),
                slope: parseFloat(document.getElementById('slope').value),
                ca: parseFloat(document.getElementById('ca').value),
                thal: parseFloat(document.getElementById('thal').value)
            };
            const resultBox = document.getElementById('result-container');
            const resultText = document.getElementById('result-text');
            try {
                const response = await fetch('/predict', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });
                if (!response.ok) {
                    throw new Error('Prediction failed.');
                }
                const result = await response.json();
                resultText.textContent = `Prediction: ${result.prediction}`;
                if (result.prediction === "Heart Disease") {
                    resultBox.className = 'result-box result-danger';
                } else {
                    resultBox.className = 'result-box result-success';
                }
            } catch (error) {
                resultText.textContent = 'An error occurred. Please try again.';
                resultBox.className = 'result-box result-error';
            }
        });
    };
</script>
</body>
</html>
